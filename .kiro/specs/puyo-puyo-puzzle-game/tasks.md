# Implementation Plan

- [x] 1. プロジェクト構造とコアクラスの設定
































  - Pyxelプロジェクトの基本構造を作成
  - メインゲームクラスとPyxelアプリケーションの初期化
  - 基本的なupdate()とdraw()メソッドの実装
  - _Requirements: 1.1, 1.2_

- [x] 2. 基本データモデルの実装











- [x] 2.1 Puyoクラスの実装






  - 個別のぷよを表現するPuyoクラスを作成
  - 色、位置属性の実装
  - 基本的なぷよの描画メソッド
  - _Requirements: 5.1_

- [x] 2.2 PuyoPairクラスの実装



  - 2つのぷよからなるペアクラスを作成
  - 回転機能の実装（4方向回転）
  - ペアの移動と位置管理
  - _Requirements: 2.2, 2.3_

- [x] 3. プレイフィールドの実装




- [x] 3.1 PlayFieldクラスの基本実装







  - 6x12グリッドの2次元配列を作成
  - ぷよの配置と取得メソッド
  - プレイフィールドの描画機能
  - _Requirements: 2.5_

- [x] 3.2 衝突判定システムの実装



  - ぷよペアと既存ぷよの衝突判定
  - 境界チェック（左右、下端）
  - 有効な移動・回転の判定
  - _Requirements: 2.2, 2.3, 2.5_

- [x] 4. 入力処理システムの実装


- [x] 4.1 InputHandlerクラスの実装





  - キーボード入力の検出と処理
  - 左右移動、回転、高速落下の入力処理
  - キーリピート処理の実装
  - _Requirements: 1.3, 2.1, 2.2, 2.3, 2.4_

- [ ] 5. ぷよ管理システムの実装


- [x] 5.1 PuyoManagerクラスの実装



  - 新しいぷよペアの生成システム
  - 現在のぷよペアと次のぷよペアの管理
  - ランダムな色の生成（4色）
  - _Requirements: 4.2_

- [x] 5.2 落下システムの実装






  - 自動落下タイマーの実装
  - 高速落下機能
  - ぷよペアの固定処理
  - _Requirements: 2.1, 2.4, 2.5_

- [ ] 6. 重力システムの実装
- [x] 6.1 重力処理の実装





  - ぷよ固定後の重力適用
  - 浮いているぷよの落下処理
  - 重力処理のアニメーション
  - _Requirements: 3.3_

- [ ] 7. 消去システムの実装
- [x] 7.1 連結判定アルゴリズムの実装



  - 同色ぷよの隣接判定（上下左右）
  - 4つ以上の連結グループの検出
  - 深度優先探索による連結判定
  - _Requirements: 3.1_

- [x] 7.2 ぷよ消去処理の実装




  - 連結グループの消去処理
  - 消去アニメーションの実装
  - 消去後の重力処理との連携
  - _Requirements: 3.1, 5.2_

- [x] 8. 連鎖システムの実装


- [x] 8.1 連鎖判定の実装


  - 重力後の新たな連結判定
  - 連鎖レベルの管理

  - 連鎖の終了判定
  - _Requirements: 3.4_



- [x] 8.2 連鎖表示システムの実装




  - 連鎖数の視覚的表示
  - 連鎖アニメーションの実装



  - 連鎖間の適切な間隔制御
  - _Requirements: 5.3_

- [-] 9. スコアシステムの実装

- [x] 9.1 ScoreManagerクラスの実装

  - 基本スコア計算（消去ぷよ数ベース）
  - 連鎖ボーナスの計算
  - スコアの加算と管理
  - _Requirements: 3.2_

- [x] 9.2 スコア表示の実装

  - 現在スコアの画面表示
  - スコア更新時のアニメーション
  - 最終スコアの表示
  - _Requirements: 4.1, 4.4_

- [ ] 10. ゲーム状態管理の実装
- [x] 10.1 GameStateクラスの実装


  - ゲーム状態の管理（MENU, PLAYING, GAME_OVER）
  - 状態遷移の制御
  - 各状態での処理分岐
  - _Requirements: 4.3, 4.4_





- [x] 10.2 ゲームオーバー判定の実装



  - プレイフィールド上端到達の判定





  - ゲームオーバー状態への遷移
  - ゲームオーバー画面の表示
  - _Requirements: 4.3, 4.4_

- [ ] 11. UI表示システムの実装
- [x] 11.1 基本UI要素の実装

  - プレイフィールドの枠線表示
  - 次のぷよペアの表示エリア
  - スコア表示エリアのレイアウト
  - _Requirements: 4.1, 4.2_

- [x] 11.2 ゲーム画面の統合

  - 全UI要素の配置と描画
  - 画面レイアウトの最適化
  - 色とフォントの統一
  - _Requirements: 5.1, 5.4_

- [ ] 12. 音響システムの実装
- [x] 12.1 AudioManagerクラスの実装





  - 音響管理システムの基本構造
  - BGM再生・停止機能
  - 効果音再生システム
  - 音量制御機能
  - _Requirements: 5.4_

- [ ] 12.2 ゲーム効果音の実装
  - ぷよ移動・回転時の効果音
  - ぷよ着地時の効果音
  - ぷよ消去時の効果音
  - 連鎖時の効果音（連鎖数に応じた音程変化）
  - _Requirements: 5.4_

- [ ] 12.3 BGMシステムの実装
  - ゲームプレイ中のBGMループ再生
  - メニュー画面のBGM
  - ゲームオーバー時の音楽
  - BGMの音量調整とフェード機能
  - _Requirements: 5.4_

- [ ] 13. ゲーム制御機能の実装
- [x] 13.1 ゲーム開始・リスタート機能

  - 新しいゲームの初期化処理
  - ゲーム状態のリセット
  - リスタート機能の実装
  - _Requirements: 6.2_

- [x] 13.2 ゲーム終了機能

  - ゲーム終了処理
  - 終了確認とクリーンアップ
  - _Requirements: 6.3_

- [ ] 14. 統合テストとデバッグ
- [x] 14.1 ゲームフロー全体のテスト


  - 開始からゲームオーバーまでの完全なフロー
  - 各機能の統合動作確認
  - バグ修正とパフォーマンス調整
  - _Requirements: 1.1, 1.2, 1.3_

- [ ] 14.2 ユーザビリティの改善


  - 操作感の調整
  - 視覚的フィードバックの改善
  - アニメーション速度の最適化
  - _Requirements: 5.4_